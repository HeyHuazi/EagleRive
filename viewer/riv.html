<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Rive 查看器</title>
    <!-- CSS -->
    <link rel="stylesheet" href="./css/variables.css">
    <link rel="stylesheet" href="./css/layout.css">
    <link rel="stylesheet" href="./css/components.css">
</head>
<body>
    <!-- Main -->
    <div class="main">
        <!-- Canvas area -->
        <div class="canvas-area">
            <div class="canvas-container bg-checker" id="canvasContainer">
                <canvas id="riveCanvas"></canvas>
                <div class="overlay" id="overlay"><div class="spinner"></div></div>
            </div>
            <!-- Bottom control bar -->
            <div class="canvas-controls">
                <!-- Zoom controls (left) -->
                <div class="zoom-controls">
                    <button class="zoom-btn" id="zoomOutBtn" title="缩小 (Ctrl+-)">
                        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M5 12h14"/>
                        </svg>
                    </button>
                    <span class="zoom-display" id="zoomDisplay">100%</span>
                    <button class="zoom-btn" id="zoomInBtn" title="放大 (Ctrl++)">
                        <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 5v14M5 12h14"/>
                        </svg>
                    </button>
                    <button class="zoom-btn" id="zoomResetBtn" title="重置缩放 (Ctrl+0)">
                        <svg class="ico" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M20 11a8.1 8.1 0 0 0-15.5-4M15 15l6-6"/>
                            <path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M4 13v6h6"/>
                        </svg>
                    </button>
                </div>
                <!-- Background controls (right) -->
                <div class="bg-controls">
                    <span class="bg-label">背景</span>
                    <div class="bg-swatches">
                        <div class="bg-swatch bg-swatch-white" data-bg="white" title="白色"></div>
                        <div class="bg-swatch bg-swatch-black" data-bg="black" title="黑色"></div>
                        <div class="bg-swatch bg-swatch-checker active" data-bg="checker" title="透明"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-inner">
                <!-- File info (always visible above tabs) -->
                <div class="file-info" id="fileInfo">
                    <div class="info-row">
                        <div class="info-item">
                            <span class="info-label">文件</span>
                            <span class="info-value" id="fileName">加载中...</span>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="info-item">
                            <span class="info-label">尺寸</span>
                            <span class="info-value" id="infoDims">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">动画</span>
                            <span class="info-value" id="infoAnimCount">-</span>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="info-item">
                            <span class="info-label">状态机</span>
                            <span class="info-value" id="infoSMCount">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">视图模型</span>
                            <span class="info-value" id="infoVMCount">-</span>
                        </div>
                    </div>
                    <div class="info-row" id="artboardRow" style="display:none">
                        <div class="info-item">
                            <span class="info-label">画板</span>
                            <select class="sel" id="artboardSelect"></select>
                        </div>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="sidebar-tabs">
                    <button class="sidebar-tab active" data-tab="statemachine">状态机</button>
                    <button class="sidebar-tab" data-tab="timeline">时间线</button>
                </div>

                <!-- Tab content -->
                <div class="sidebar-body">
                    <!-- 状态机 + Data Binding -->
                    <div class="panel active" id="panel-statemachine">
                        <div class="section" id="smSection">
                            <select class="sel" id="smSelect"><option value="">选择...</option></select>
                            <div id="smInputs" style="display:none; margin-top:8px"></div>
                        </div>
                        <!-- Data Binding（状态机下方） -->
                        <div class="section" id="vmSection" style="display:none">
                            <div class="sm-type-hd" style="margin-bottom:8px">Data Binding</div>
                            <select class="sel" id="vmSelect"><option value="">无视图模型</option></select>
                            <div id="vmProps" style="margin-top:8px"></div>
                        </div>
                    </div>
                    <!-- 时间线 -->
                    <div class="panel" id="panel-timeline">
                        <div class="playback-row">
                            <button class="btn-playback" id="btnPlay" title="空格键 播放/暂停">
                                <svg class="ico" id="icoPlay" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M6 4h4v16H6V4z"/><path d="M14 4h4v16h-4V4z"/>
                                </svg>
                                <span id="playLabel">暂停</span>
                            </button>
                            <button class="btn-playback" id="btnRestart" title="R 键重新开始">
                                <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 21"/>
                                    <path d="M21 3v9h-9"/>
                                </svg>
                                <span>重新播放</span>
                            </button>
                        </div>
                        <div id="animList"><div class="empty">加载中...</div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Rive Runtime -->
    <script src="https://unpkg.com/@rive-app/webgl2@2.35.0"></script>

    <!-- Modules -->
    <script src="./js/utils.js"></script>
    <script src="./js/animation.js"></script>
    <script src="./js/state-machine.js"></script>
    <script src="./js/data-binding.js"></script>
    <script src="./js/playback.js"></script>
    <script src="./js/zoom.js"></script>
    <script src="./js/ui.js"></script>

    <!-- Main App -->
    <script src="./js/app.js"></script>
</body>
</html>
