<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Rive 查看器</title>
    <!-- CSS -->
    <link rel="stylesheet" href="./css/variables.css">
    <link rel="stylesheet" href="./css/layout.css">
    <link rel="stylesheet" href="./css/components.css">
</head>
<body>
    <!-- Main -->
    <div class="main">
        <!-- Canvas area -->
        <div class="canvas-area">
            <div class="canvas-container bg-checker" id="canvasContainer">
                <canvas id="riveCanvas"></canvas>
                <div class="overlay" id="overlay"><div class="spinner"></div></div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-inner">
                <!-- File info (always visible above tabs) -->
                <div class="file-info" id="fileInfo">
                    <div class="info-row">
                        <div class="info-item">
                            <span class="info-label">文件</span>
                            <span class="info-value" id="fileName">加载中...</span>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="info-item">
                            <span class="info-label">尺寸</span>
                            <span class="info-value" id="infoDims">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">动画</span>
                            <span class="info-value" id="infoAnimCount">-</span>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="info-item">
                            <span class="info-label">状态机</span>
                            <span class="info-value" id="infoSMCount">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">视图模型</span>
                            <span class="info-value" id="infoVMCount">-</span>
                        </div>
                    </div>
                    <div class="info-row" id="artboardRow" style="display:none">
                        <div class="info-item">
                            <span class="info-label">画板</span>
                            <select class="sel" id="artboardSelect"></select>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="info-item">
                            <span class="info-label">背景</span>
                            <div class="bg-swatches">
                                <div class="bg-swatch bg-swatch-white" data-bg="white" title="白色"></div>
                                <div class="bg-swatch bg-swatch-black" data-bg="black" title="黑色"></div>
                                <div class="bg-swatch bg-swatch-checker active" data-bg="checker" title="透明"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="sidebar-tabs">
                    <button class="sidebar-tab active" data-tab="statemachine">状态机</button>
                    <button class="sidebar-tab" data-tab="timeline">时间线</button>
                </div>

                <!-- Tab content -->
                <div class="sidebar-body">
                    <!-- 状态机 + Data Binding -->
                    <div class="panel active" id="panel-statemachine">
                        <div class="section" id="smSection">
                            <select class="sel" id="smSelect"><option value="">选择...</option></select>
                            <div id="smInputs" style="display:none; margin-top:8px"></div>
                        </div>
                        <!-- Data Binding（状态机下方） -->
                        <div class="section" id="vmSection" style="display:none">
                            <div class="sm-type-hd" style="margin-bottom:8px">Data Binding</div>
                            <select class="sel" id="vmSelect"><option value="">无视图模型</option></select>
                            <div id="vmProps" style="margin-top:8px"></div>
                        </div>
                    </div>
                    <!-- 时间线 -->
                    <div class="panel" id="panel-timeline">
                        <div class="playback-row">
                            <button class="btn-playback" id="btnPlay" title="空格键 播放/暂停">
                                <svg class="ico" id="icoPlay" viewBox="0 0 24 24"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                                <span id="playLabel">暂停</span>
                            </button>
                            <button class="btn-playback" id="btnRestart" title="R 键重新开始">
                                <svg class="ico" viewBox="0 0 24 24"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
                                <span>重新播放</span>
                            </button>
                        </div>
                        <div id="animList"><div class="empty">加载中...</div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Rive Runtime -->
    <script src="https://unpkg.com/@rive-app/webgl2@2.35.0"></script>

    <!-- Modules -->
    <script src="./js/utils.js"></script>
    <script src="./js/animation.js"></script>
    <script src="./js/state-machine.js"></script>
    <script src="./js/data-binding.js"></script>
    <script src="./js/playback.js"></script>
    <script src="./js/ui.js"></script>

    <!-- Main App -->
    <script src="./js/app.js"></script>
</body>
</html>
